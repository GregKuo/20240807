<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台股即時股價</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>台股即時股價</h1>
    <table id="stockTable">
        <tr>
            <th>股票代碼</th>
            <th>公司名稱</th>
            <th>成交價</th>
            <th>漲跌</th>
            <th>漲跌幅</th>
        </tr>
    </table>

    <script>
        const stockCodes = ['2330', '2317', '2454']; // 您可以根據需要添加或修改股票代碼

        function fetchStockData() {
            const apiUrl = 'https://openapi.twse.com.tw/v1/exchangeReport/STOCK_DAY_AVG_ALL';

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById('stockTable');
                    tableBody.innerHTML = '<tr><th>股票代碼</th><th>公司名稱</th><th>成交價</th><th>漲跌</th><th>漲跌幅</th></tr>';

                    stockCodes.forEach(code => {
                        const stock = data.find(item => item.Code === code);
                        if (stock) {
                            const row = tableBody.insertRow();
                            row.insertCell(0).textContent = stock.Code;
                            row.insertCell(1).textContent = stock.Name;
                            row.insertCell(2).textContent = stock.ClosingPrice;
                            row.insertCell(3).textContent = stock.Change;
                            row.insertCell(4).textContent = stock.ChangePercent + '%';
                        }
                    });
                })
                .catch(error => console.error('Error:', error));
        }

        fetchStockData();
        setInterval(fetchStockData, 60000); // 每分鐘更新一次數據
    </script>
</body>
</html>
